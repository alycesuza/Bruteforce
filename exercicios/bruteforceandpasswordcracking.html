<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>INE - ruteforce and Password cracking Offline</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	text-indent: -1.7em;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(55, 53, 47, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-gray_background {
	background: rgba(241, 241, 239, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.highlight-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-gray_background {
	background: rgba(241, 241, 239, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(244, 240, 247, 0.8);
}
.block-color-pink_background {
	background: rgba(249, 238, 243, 0.8);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-pink { background-color: rgba(245, 224, 233, 1); }
.select-value-color-purple { background-color: rgba(232, 222, 238, 1); }
.select-value-color-green { background-color: rgba(219, 237, 219, 1); }
.select-value-color-gray { background-color: rgba(227, 226, 224, 1); }
.select-value-color-opaquegray { background-color: rgba(255, 255, 255, 0.0375); }
.select-value-color-orange { background-color: rgba(250, 222, 201, 1); }
.select-value-color-brown { background-color: rgba(238, 224, 218, 1); }
.select-value-color-red { background-color: rgba(255, 226, 221, 1); }
.select-value-color-yellow { background-color: rgba(253, 236, 200, 1); }
.select-value-color-blue { background-color: rgba(211, 229, 239, 1); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="4a2db0cb-df34-4cce-971b-265e8cc65911" class="page sans"><header><h1 class="page-title">INE - <strong>ruteforce and Password cracking Offline</strong></h1></header><div class="page-body"><h1 id="d93cf16c-a42a-429a-b005-5ffe108184ed" class=""><strong>ambiente de laboratório</strong></h1><p id="e7e4dd8e-75b5-46ca-a046-79b0705d7af6" class="">Neste ambiente de laboratório, os usuários têm acesso a uma instância de GUI do Kali. Esta máquina possui ferramentas John the Ripper (JTR) e Hashcat.</p><p id="35dea1ff-1b99-478b-98e1-2f10bcd40d69" class="">Objetivo: Realizar as seguintes atividades:</p><ol type="1" id="63add0e7-259f-4ab5-b0e1-6e256d4cab73" class="numbered-list" start="1"><li>John The Ripper/Hashcat quebra o hash do usuário &quot;admin&quot; e recupera a senha.</li></ol><ol type="1" id="be177d72-d8cf-4939-865f-43b221315215" class="numbered-list" start="2"><li>Use John The Ripper/Hashcat para encontrar senhas para arquivos .docx protegidos do Microsoft Office.</li></ol><p id="244f05e9-1a97-431d-af45-462d644c7c8b" class="">Use um dicionário de senhas:<code>/root/Desktop/wordlists/1000000-password-seclists.txt</code></p><p id="74cc4bff-1d05-4866-b725-f77ea9f1d9c8" class="">
</p><p id="240ca0f8-444e-4c05-8ced-ef4c84b808d5" class="">
</p><h1 id="64d8a90d-3bb4-454c-a568-05713f36fcaa" class=""><strong>Quebrando o hash do usuário &quot;admin&quot; e recuperando a senha</strong></h1><h2 id="aff3007d-292c-42e2-ade2-91af41614858" class="">JRT</h2><pre id="dde21071-6729-4a79-9f20-73f518351cec" class="code"><code>root@INE:~# cat /etc/passwd
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:x:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:x:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:x:103:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:x:104:105::/nonexistent:/usr/sbin/nologin
rtkit:x:105:106:RealtimeKit,,,:/proc:/usr/sbin/nologin
xrdp:x:106:112::/run/xrdp:/usr/sbin/nologin
usbmux:x:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
avahi:x:108:115:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin
pulse:x:109:116:PulseAudio daemon,,,:/run/pulse:/usr/sbin/nologin
sddm:x:110:118:Simple Desktop Display Manager:/var/lib/sddm:/bin/false
geoclue:x:111:119::/var/lib/geoclue:/usr/sbin/nologin
tomcat:x:1000:1000::/opt/tomcat:/bin/false
mysql:x:112:120:MySQL Server,,,:/nonexistent:/bin/false
stunnel4:x:113:122::/var/run/stunnel4:/usr/sbin/nologin
_rpc:x:114:65534::/run/rpcbind:/usr/sbin/nologin
dnsmasq:x:115:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
sslh:x:116:124::/nonexistent:/usr/sbin/nologin
ntp:x:117:125::/nonexistent:/usr/sbin/nologin
arpwatch:x:118:127:ARP Watcher,,,:/var/lib/arpwatch:/bin/sh
Debian-exim:x:119:128::/var/spool/exim4:/usr/sbin/nologin
debian-tor:x:120:129::/var/lib/tor:/bin/false
redsocks:x:121:130::/var/run/redsocks:/usr/sbin/nologin
rwhod:x:122:65534::/var/spool/rwho:/usr/sbin/nologin
freerad:x:123:131::/etc/freeradius:/usr/sbin/nologin
iodine:x:124:65534::/run/iodine:/usr/sbin/nologin
tcpdump:x:125:132::/nonexistent:/usr/sbin/nologin
miredo:x:126:65534::/var/run/miredo:/usr/sbin/nologin
statd:x:127:65534::/var/lib/nfs:/usr/sbin/nologin
redis:x:128:134::/var/lib/redis:/usr/sbin/nologin
postgres:x:129:135:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
inetsim:x:130:138::/var/lib/inetsim:/usr/sbin/nologin
sshd:x:131:65534::/run/sshd:/usr/sbin/nologin
Debian-snmp:x:132:139::/var/lib/snmp:/bin/false
_gvm:x:133:141::/var/lib/openvas:/usr/sbin/nologin
saned:x:134:142::/var/lib/saned:/usr/sbin/nologin
king-phisher:x:135:143::/var/lib/king-phisher:/usr/sbin/nologin
_caldera:x:136:144::/var/lib/caldera:/usr/sbin/nologin
dradis:x:137:145::/var/lib/dradis:/usr/sbin/nologin
beef-xss:x:138:146::/var/lib/beef-xss:/usr/sbin/nologin
uuidd:x:139:147::/run/uuidd:/usr/sbin/nologin
memcache:x:140:148:Memcached,,,:/nonexistent:/bin/false
arangodb:x:999:999:ArangoDB Application User:/usr/share/arangodb3:/bin/false
admin:x:1001:1001:,,,:/home/admin:/bin/bash</code></pre><p id="e89508c4-152c-4c0d-b54d-f186daddd3ad" class="">Os usuários de interesse são root e admin:</p><pre id="619f4eeb-7f64-4d19-9aa7-c3396015ef80" class="code"><code>
root:x:0:0:root:/root:/bin/bash
admin:x:1001:1001:,,,:/home/admin:/bin/bash</code></pre><p id="638cd0fb-9b65-4dc5-a7b6-71d26dda7cfe" class="">Então, confira <code>/etc/shadow</code>:</p><pre id="0d628a43-dcc6-4742-8d92-c454438397c1" class="code"><code>
root@INE:~# cat /etc/shadow
root:$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:18604:0:99999:7:::
daemon:*:19002:0:99999:7:::
bin:*:19002:0:99999:7:::
sys:*:19002:0:99999:7:::
sync:*:19002:0:99999:7:::
games:*:19002:0:99999:7:::
man:*:19002:0:99999:7:::
lp:*:19002:0:99999:7:::
mail:*:19002:0:99999:7:::
news:*:19002:0:99999:7:::
uucp:*:19002:0:99999:7:::
proxy:*:19002:0:99999:7:::
www-data:*:19002:0:99999:7:::
backup:*:19002:0:99999:7:::
list:*:19002:0:99999:7:::
irc:*:19002:0:99999:7:::
gnats:*:19002:0:99999:7:::
nobody:*:19002:0:99999:7:::
_apt:*:19002:0:99999:7:::
systemd-network:*:19004:0:99999:7:::
systemd-resolve:*:19004:0:99999:7:::
systemd-timesync:*:19004:0:99999:7:::
messagebus:*:19004:0:99999:7:::
rtkit:*:19004:0:99999:7:::
xrdp:!:19004:0:99999:7:::
usbmux:*:19004:0:99999:7:::
avahi:*:19004:0:99999:7:::
pulse:*:19004:0:99999:7:::
sddm:*:19004:0:99999:7:::
geoclue:*:19004:0:99999:7:::
tomcat:!:19004:0:99999:7:::
mysql:!:19004:0:99999:7:::
stunnel4:!:19004:0:99999:7:::
_rpc:*:19004:0:99999:7:::
dnsmasq:*:19004:0:99999:7:::
sslh:!:19004:0:99999:7:::
ntp:*:19004:0:99999:7:::
arpwatch:!:19004:0:99999:7:::
Debian-exim:!:19004:0:99999:7:::
debian-tor:*:19004:0:99999:7:::
redsocks:!:19004:0:99999:7:::
rwhod:*:19004:0:99999:7:::
freerad:*:19004:0:99999:7:::
iodine:*:19004:0:99999:7:::
tcpdump:*:19004:0:99999:7:::
miredo:*:19004:0:99999:7:::
statd:*:19004:0:99999:7:::
redis:*:19004:0:99999:7:::
postgres:*:19004:0:99999:7:::
inetsim:*:19004:0:99999:7:::
sshd:*:19004:0:99999:7:::
Debian-snmp:!:19004:0:99999:7:::
_gvm:*:19004:0:99999:7:::
saned:*:19004:0:99999:7:::
king-phisher:*:19004:0:99999:7:::
_caldera:*:19004:0:99999:7:::
dradis:*:19004:0:99999:7:::
beef-xss:*:19004:0:99999:7:::
uuidd:*:19004:0:99999:7:::
memcache:!:19004:0:99999:7:::
arangodb:!:19004::::::
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::/</code></pre><p id="1cd3257a-7b88-4e8e-ae45-d1777439b016" class="">Descobriu que os usuários root e admin têm hashes:</p><pre id="2236bf08-bbd6-4b11-9667-78ea998686ab" class="code"><code>root:$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:18604:0:99999:7:::
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::/</code></pre><p id="bb2c54b6-c4fe-4994-924b-3e5e29bbbb6d" class="">Use unshadow para mesclar <code>/etc/passwd</code>e <code>/etc/shadow</code>:</p><pre id="74b9413b-4b31-4c5b-a966-a03ff56744eb" class="code"><code>unshadow /etc/passwd /etc/shadow &gt; hashes</code></pre><p id="a7c13b64-53cb-4ef8-98c9-f865c3c6d04a" class="">Veja o arquivo mesclado:</p><pre id="a5bc6eee-c11f-4ed2-9703-b66bd7360fe2" class="code"><code>root@INE:~# cat hashes
root:$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:0:0:root:/root:/bin/bash
daemon:*:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:*:2:2:bin:/bin:/usr/sbin/nologin
sys:*:3:3:sys:/dev:/usr/sbin/nologin
sync:*:4:65534:sync:/bin:/bin/sync
games:*:5:60:games:/usr/games:/usr/sbin/nologin
man:*:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:*:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:*:8:8:mail:/var/mail:/usr/sbin/nologin
news:*:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:*:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:*:13:13:proxy:/bin:/usr/sbin/nologin
www-data:*:33:33:www-data:/var/www:/usr/sbin/nologin
backup:*:34:34:backup:/var/backups:/usr/sbin/nologin
list:*:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:*:39:39:ircd:/run/ircd:/usr/sbin/nologin
gnats:*:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:*:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:*:100:65534::/nonexistent:/usr/sbin/nologin
systemd-network:*:101:102:systemd Network Management,,,:/run/systemd:/usr/sbin/nologin
systemd-resolve:*:102:103:systemd Resolver,,,:/run/systemd:/usr/sbin/nologin
systemd-timesync:*:103:104:systemd Time Synchronization,,,:/run/systemd:/usr/sbin/nologin
messagebus:*:104:105::/nonexistent:/usr/sbin/nologin
rtkit:*:105:106:RealtimeKit,,,:/proc:/usr/sbin/nologin
xrdp:!:106:112::/run/xrdp:/usr/sbin/nologin
usbmux:*:107:46:usbmux daemon,,,:/var/lib/usbmux:/usr/sbin/nologin
avahi:*:108:115:Avahi mDNS daemon,,,:/run/avahi-daemon:/usr/sbin/nologin
pulse:*:109:116:PulseAudio daemon,,,:/run/pulse:/usr/sbin/nologin
sddm:*:110:118:Simple Desktop Display Manager:/var/lib/sddm:/bin/false
geoclue:*:111:119::/var/lib/geoclue:/usr/sbin/nologin
tomcat:!:1000:1000::/opt/tomcat:/bin/false
mysql:!:112:120:MySQL Server,,,:/nonexistent:/bin/false
stunnel4:!:113:122::/var/run/stunnel4:/usr/sbin/nologin
_rpc:*:114:65534::/run/rpcbind:/usr/sbin/nologin
dnsmasq:*:115:65534:dnsmasq,,,:/var/lib/misc:/usr/sbin/nologin
sslh:!:116:124::/nonexistent:/usr/sbin/nologin
ntp:*:117:125::/nonexistent:/usr/sbin/nologin
arpwatch:!:118:127:ARP Watcher,,,:/var/lib/arpwatch:/bin/sh
Debian-exim:!:119:128::/var/spool/exim4:/usr/sbin/nologin
debian-tor:*:120:129::/var/lib/tor:/bin/false
redsocks:!:121:130::/var/run/redsocks:/usr/sbin/nologin
rwhod:*:122:65534::/var/spool/rwho:/usr/sbin/nologin
freerad:*:123:131::/etc/freeradius:/usr/sbin/nologin
iodine:*:124:65534::/run/iodine:/usr/sbin/nologin
tcpdump:*:125:132::/nonexistent:/usr/sbin/nologin
miredo:*:126:65534::/var/run/miredo:/usr/sbin/nologin
statd:*:127:65534::/var/lib/nfs:/usr/sbin/nologin
redis:*:128:134::/var/lib/redis:/usr/sbin/nologin
postgres:*:129:135:PostgreSQL administrator,,,:/var/lib/postgresql:/bin/bash
inetsim:*:130:138::/var/lib/inetsim:/usr/sbin/nologin
sshd:*:131:65534::/run/sshd:/usr/sbin/nologin
Debian-snmp:!:132:139::/var/lib/snmp:/bin/false
_gvm:*:133:141::/var/lib/openvas:/usr/sbin/nologin
saned:*:134:142::/var/lib/saned:/usr/sbin/nologin
king-phisher:*:135:143::/var/lib/king-phisher:/usr/sbin/nologin
_caldera:*:136:144::/var/lib/caldera:/usr/sbin/nologin
dradis:*:137:145::/var/lib/dradis:/usr/sbin/nologin
beef-xss:*:138:146::/var/lib/beef-xss:/usr/sbin/nologin
uuidd:*:139:147::/run/uuidd:/usr/sbin/nologin
memcache:!:140:148:Memcached,,,:/nonexistent:/bin/false
arangodb:!:999:999:ArangoDB Application User:/usr/share/arangodb3:/bin/false
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:1001:1001:,,,:/home/admin:/bin/bash</code></pre><p id="88bd4deb-5489-4e18-be23-7430662828e4" class="">As informações válidas são:</p><pre id="eb67cabb-681d-495e-963a-8ad275da8c84" class="code"><code>root:$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:0:0:root:/root:/bin/bash
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:1001:1001:,,,:/home/admin:/bin/bash</code></pre><p id="34c4b7ba-7421-437e-a5b8-9aebaffa7cfa" class="">Usando um dicionário de senhas <code>/root/Desktop/wordlists/1000000-password-seclists.txt</code>, carregue apenas os usuários root e admin:</p><pre id="1caa8e9c-44ad-4a9a-a77f-5831fec7f21a" class="code"><code>john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt --users=root,admin hashes</code></pre><pre id="e45362a0-053f-4743-b378-83594102bfbe" class="code"><code>root@INE:~# john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt --users=root,admin hashes
Using default input encoding: UTF-8
Loaded 2 password hashes with 2 different salts (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 48 OpenMP threads
Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status
foxtrot          (admin)     
password         (root)     
2g 0:00:00:08 DONE (2022-07-15 07:22) 0.2392g/s 734.9p/s 1469c/s 1469C/s 123456..786786
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.</code></pre><p id="82c9e5d5-9988-4ab1-8fab-53218e3f6590" class="">Mostrar todas as senhas quebradas: <code>root:password</code>,<code>admin:foxtrot</code></p><pre id="bf2b05ad-df44-446c-8a70-3707d5af8f76" class="code"><code>john --show hashes</code></pre><pre id="0207502c-c7f9-4a28-bb00-8b6799e907c6" class="code"><code>root@INE:~# john --show hashes
root:password:0:0:root:/root:/bin/bash
admin:foxtrot:1001:1001:,,,:/home/admin:/bin/bash

2 password hashes cracked, 0 left</code></pre><ul id="e3a1b3c4-d85b-4e90-80ca-6e63b42214c7" class="bulleted-list"><li style="list-style-type:disc"><code>-show</code><code>/root/.john/john.pot</code><p id="e74110dc-f890-42b5-a4a2-e21f3a573174" class="">O conteúdo exibido na verdade vem do</p><p id="1539cfdd-7c67-4292-8551-46f04cc94c26" class="">arquivo:</p></li></ul><pre id="2154c2ef-8865-45c4-b131-915be6f6e14e" class="code"><code>root@INE:~# cat /root/.john/john.pot
$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:foxtrot
$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:password</code></pre><h3 id="69dbc8c0-f6d8-425e-8187-53acb9e04c06" class=""><strong>hashcat</strong></h3><p id="85d516c4-1043-46f2-8eeb-fbbc11327f51" class="">Ao contrário de John, a maneira mais fácil de usar o Hashcat é apenas fornecer o próprio hash da senha. Copie quaisquer hashes que queremos quebrar em um novo arquivo de texto, vamos chamá-lo de hashes.txt:</p><pre id="26e18249-a42c-4330-a898-b51faa445a4d" class="code"><code>$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/
$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/</code></pre><p id="eb7f16ed-c2da-45d7-ae31-c42316a7da33" class="">Hashcat contém vários modos que podem ser executados, dependendo do tipo de hash usado. Vimos anteriormente que John identificou nosso hash de sombra como <code>sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x]</code>, para que possamos digitar <code>hashcat --help</code>para revelar todas as opções dessa ferramenta e os diferentes modos disponíveis. Na lista, descobrimos que <code>sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x]</code>é modo 1800:</p><pre id="150e3577-81eb-424c-a37c-67fbc79f90f6" class="code"><code>root@INE:~# hashcat --help | grep sha512
   1770 | sha512(utf16le($pass))                              | Raw Hash
   1710 | sha512($pass.$salt)                                 | Raw Hash salted and/or iterated
   1720 | sha512($salt.$pass)                                 | Raw Hash salted and/or iterated
   1740 | sha512($salt.utf16le($pass))                        | Raw Hash salted and/or iterated
   1730 | sha512(utf16le($pass).$salt)                        | Raw Hash salted and/or iterated
   6500 | AIX {ssha512}                                       | Operating System
   1800 | sha512crypt $6$, SHA512 (Unix)                      | Operating System
  21600 | Web2py pbkdf2-sha512                                | Framework
  20200 | Python passlib pbkdf2-sha512                        | Framework
  21000 | BitShares v0.x - sha512(sha512_bin(pass))           | Cryptocurrency Wallet</code></pre><pre id="175b2828-3299-46e1-bf02-7d434d90c13a" class="code"><code>
hashcat -m 1800 -a 0 -o cracked.txt hashes.txt /root/Desktop/wordlists/1000000-password-seclists.txt</code></pre><ul id="0481747e-7413-4761-a353-03228aa805cc" class="bulleted-list"><li style="list-style-type:disc"><code>m</code><p id="03dc7523-5ad0-45dd-9a33-cd91d3e47eb2" class="">: Especifica o modo a ser usado.</p></li></ul><ul id="0b264e73-44cc-4cad-ab1f-f9dde19efeb4" class="bulleted-list"><li style="list-style-type:disc"><code>a</code><p id="10ed109d-5098-4c19-bf22-01789ea20113" class="">: Determina o tipo de ataque, 0 significa o modo direto padrão.</p></li></ul><ul id="49d32ab8-204a-4dd9-9c9f-2c9c7a830857" class="bulleted-list"><li style="list-style-type:disc"><code>o</code><code>/root/Desktop/wordlists/1000000-password-seclists.txt</code><p id="202bec1f-c839-4b17-bddf-c70f6c080d79" class="">: Especifica que o arquivo de saída é cracked.txt e o arquivo de entrada é hashes.txt contendo hashes, usando um dicionário</p><p id="49bfb32f-80c1-44f1-b92c-7ac86f48a658" class="">.</p></li></ul><pre id="64b2bbb1-d4ff-47ab-83b6-236dfcfe7880" class="code"><code>
root@INE:~# hashcat -m 1800 -a 0 -o cracked.txt hashes.txt /root/Desktop/wordlists/1000000-password-seclists.txt
hashcat (v6.2.5) starting

OpenCL API (OpenCL 2.0 pocl 1.8  Linux, None+Asserts, RELOC, LLVM 11.1.0, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
=====================================================================================================================================
* Device #1: pthread-AMD EPYC 7642 48-Core Processor, 47227/94518 MB (16384 MB allocatable), 48MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 2 digests; 2 unique digests, 2 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Uses-64-Bit

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 0 MB


Dictionary cache built:
* Filename..: /root/Desktop/wordlists/1000000-password-seclists.txt
* Passwords.: 1000003
* Bytes.....: 8529147
* Keyspace..: 1000003
* Runtime...: 0 secs

                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1800 (sha512crypt $6$, SHA512 (Unix))
Hash.Target......: hashes.txt
Time.Started.....: Fri Jul 15 08:09:14 2022 (6 secs)
Time.Estimated...: Fri Jul 15 08:09:20 2022 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:      548 H/s (42.64ms) @ Accel:1024 Loops:128 Thr:1 Vec:4
Recovered........: 2/2 (100.00%) Digests, 2/2 (100.00%) Salts
Progress.........: 4096/2000006 (0.20%)
Rejected.........: 0/4096 (0.00%)
Restore.Point....: 1024/1000003 (0.10%)
Restore.Sub.#1...: Salt:1 Amplifier:0-1 Iteration:4992-5000
Candidate.Engine.: Device Generator
Candidates.#1....: sports -&gt; ball

Started: Fri Jul 15 08:08:06 2022
Stopped: Fri Jul 15 08:09:21 2022</code></pre><p id="c26d789c-ff82-4487-a35c-0f386f29f953" class="">Exiba o conteúdo de cracked.txt e visualize a senha em texto simples:</p><pre id="4b4c6487-ed6c-400a-b8b9-3984e21d4d3e" class="code"><code>root@INE:~# cat cracked.txt
$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:password
$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:foxtrot</code></pre><h1 id="1b8ad312-298f-4b85-9974-b2ecb542c32e" class=""><strong>Encontre senhas para arquivos .docx protegidos do Microsoft Office</strong></h1><h3 id="597e1c71-6b61-4020-b0db-22816081870a" class=""><strong>JRT</strong></h3><p id="e64a32dd-36e9-4977-b28e-193db581f509" class=""><strong>Referência: </strong><a href="https://null-byte.wonderhowto.com/how-to/crack-password-protected-microsoft-office-files-including-word-docs-excel-spreadsheets-0193959/">Quebra de arquivos do Microsoft Office protegidos por senha, incluindo documentos do Word e planilhas do Excel</a></p><p id="4e31a997-03d6-485f-94f1-37fb6a80eb31" class="">Primeiro instale <a href="https://github.com/openwall/john/blob/bleeding-jumbo/run/office2john.py">o office2john</a></p><p id="2be2c9b9-14b3-45b9-9910-468eceb1a82a" class="">Extraia hashes de arquivos do Office protegidos por senha</p><pre id="d1e42ac6-d6ee-4ce2-bf8f-c5fae57d51b6" class="code"><code>python office2john.py Desktop/MS_Word_Document.docx &gt; hash.txt
cat hash.txt</code></pre><p id="6c0de5a1-9b5d-42ed-9011-254b554742c8" class="">O hash salvo corresponde ao Microsoft Office 2013</p><pre id="db86f27e-64ff-478d-b00b-c91c227e02ab" class="code"><code>MS_Word_Document.docx:$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><pre id="a2ef565f-3bb8-4a52-b6dc-0f98e76d7f05" class="code"><code>john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt hash.txt</code></pre><pre id="c92131a8-b2d5-49fb-84e3-13eeb65c0acc" class="code"><code>
root@INE:~# john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt hash.txt
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 1 password hash (Office, 2007/2010/2013 [SHA1 256/256 AVX2 8x / SHA512 256/256 AVX2 4x AES])
Cost 1 (MS Office version) is 2013 for all loaded hashes
Cost 2 (iteration count) is 100000 for all loaded hashes
Will run 48 OpenMP threads
Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status
muenchen         (MS_Word_Document.docx)     
1g 0:00:05:08 DONE (2022-07-15 11:20) 0.003240g/s 77.14p/s 77.14c/s 77.14C/s shake..963741
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.</code></pre><pre id="06eb2375-e217-4323-a150-ed622fbd2be4" class="code"><code>cat /root/.john/john.pot
john --show hash.txt</code></pre><p id="97f801b1-0ed4-4cfa-9a32-9029fd5a4815" class="">A senha para o documento MS_Word_Document.docx é <code>muenchen</code>.</p><pre id="592302c2-d12d-4331-8778-d8aa0fb131fb" class="code"><code>
root@INE:~# cat /root/.john/john.pot
$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2:muenchen
root@INE:~# john --show hash.txt
MS_Word_Document.docx:muenchen

1 password hash cracked, 0 left</code></pre><h3 id="515f8166-b873-4857-86aa-e043e2495a4e" class=""><strong>hashcat</strong></h3><p id="82ba056c-d509-4124-bc92-2743ba2194ca" class=""><strong>Referência: </strong><a href="https://tinyapps.org/docs/hashcat.html">crack a proteção por senha do Microsoft Office via hashcat localmente ou na nuvem</a></p><p id="52a1b540-7d63-4c25-9633-f715a15567e9" class="">Verifique as propriedades do arquivo de MS_Word_Document.docx, o tipo de arquivo é documento do Word 2007.</p><p id="436294a9-92e1-430f-a39f-1abec44c0b42" class="">Use <a href="https://github.com/stricture/hashstack-server-plugin-hashcat/blob/master/scrapers/office2hashcat.py">office2hashcat.py para</a> recuperar o hash criptográfico de um documento do Word protegido por senha, salvando-o em hash.txt:</p><pre id="cb753770-8044-44aa-b02b-17864dbbe58f" class="code"><code>./office2hashcat.py Desktop/MS_Word_Document.docx &gt; hash.txt
cat hash.txt</code></pre><p id="2891ba47-2880-4492-a8b0-839f1a936db5" class="">ID de hash para MS Office 2013</p><pre id="b82eb6f1-f53a-4b1c-bca9-96b9868a115f" class="code"><code>
$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><p id="2bd8a3b8-2df0-4cb5-a3a2-15dd43e859e9" class="">Foi atribuído o número de modo de hash 9600 por hashcat</p><pre id="6a6436ea-c508-466e-b7d7-16a2b63cbb1c" class="code"><code>
root@INE:~# hashcat --help | grep &quot;MS Office&quot;
   9400 | MS Office 2007                                      | Document
   9500 | MS Office 2010                                      | Document
   9600 | MS Office 2013                                      | Document
  25300 | MS Office 2016 - SheetProtection                    | Document
   9700 | MS Office &lt;= 2003 $0/$1, MD5 + RC4                  | Document
   9710 | MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #1     | Document
   9720 | MS Office &lt;= 2003 $0/$1, MD5 + RC4, collider #2     | Document
   9810 | MS Office &lt;= 2003 $3, SHA1 + RC4, collider #1       | Document
   9820 | MS Office &lt;= 2003 $3, SHA1 + RC4, collider #2       | Document
   9800 | MS Office &lt;= 2003 $3/$4, SHA1 + RC4                 | Document</code></pre><p id="18142bee-799a-4308-8de9-1e8f459ab184" class="">Passe os seguintes parâmetros para o hashcat:</p><ul id="5a550642-5dc0-4448-954b-7fe8cfcbdbf5" class="bulleted-list"><li style="list-style-type:disc"><code>a 0</code><p id="3a7e6743-71d1-4ad1-b933-b7c5abaf9568" class="">: defina o modo de ataque para ataque direto/dicionário</p></li></ul><ul id="3ea94fae-283a-48a0-923d-734f9b82fe0a" class="bulleted-list"><li style="list-style-type:disc"><code>m 9600</code><p id="812d299e-dcc2-4f33-97db-c1832c18e196" class="">: defina o modo de hash para MS Office 2013</p></li></ul><ul id="ce490cea-597f-4d52-a388-1961f937f503" class="bulleted-list"><li style="list-style-type:disc"><code>-status</code><p id="a0f918d9-fa1c-4511-86cb-e69dd0fb995b" class="">: Tela de status de atualização automática</p></li></ul><ul id="a85f415d-975d-45a8-a7d7-1c9bb940469e" class="bulleted-list"><li style="list-style-type:disc"><code>o found.txt</code><p id="77862a3c-ccd7-4c3b-ac7b-df7918ee5f25" class="">: Saída da senha recuperada para found.txt</p></li></ul><ul id="acc1dc13-c711-4d28-be23-6893689362c7" class="bulleted-list"><li style="list-style-type:disc"><code>hash.txt</code><p id="0e34803b-31df-4f21-abe7-c6572a2527b2" class="">: o hash salvo na etapa anterior</p></li></ul><ul id="03d90e6d-6de1-458d-a6e6-26d38999efae" class="bulleted-list"><li style="list-style-type:disc"><code>/root/Desktop/wordlists/1000000-password-seclists.txt</code><p id="2c78ab07-c67b-43db-81a9-74000487fe4d" class="">: dicionário de senhas</p></li></ul><pre id="80f77096-648a-4cdc-9fa8-38946f03626b" class="code"><code>
hashcat -a 0 -m 9600 --status -o found.txt hash.txt /root/Desktop/wordlists/1000000-password-seclists.txt</code></pre><pre id="ec5559cb-63f2-4efb-880b-62782f3d916d" class="code"><code>
root@INE:~# hashcat -a 0 -m 9600 --status -o found.txt hash.txt /root/Desktop/wordlists/1000000-password-seclists.txt 
hashcat (v6.2.5) starting

OpenCL API (OpenCL 2.0 pocl 1.8  Linux, None+Asserts, RELOC, LLVM 11.1.0, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
=====================================================================================================================================
* Device #1: pthread-AMD EPYC 7642 48-Core Processor, 47227/94518 MB (16384 MB allocatable), 48MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt
* Slow-Hash-SIMD-LOOP
* Uses-64-Bit

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 0 MB

Dictionary cache built:
* Filename..: /root/Desktop/wordlists/1000000-password-seclists.txt
* Passwords.: 1000003
* Bytes.....: 8529147
* Keyspace..: 1000003
* Runtime...: 0 secs

[s]tatus [p]ause [b]ypass [c]heckpoint [f]inish [q]uit =&gt; 

Session..........: hashcat
Status...........: Running
Hash.Mode........: 9600 (MS Office 2013)
Hash.Target......: $office$*2013*100000*256*16*ff2563844faca58a12fc42c...4336a2
Time.Started.....: Fri Jul 15 10:21:09 2022 (7 secs)
Time.Estimated...: Fri Jul 15 13:46:06 2022 (3 hours, 24 mins)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:       81 H/s (6.91ms) @ Accel:1024 Loops:64 Thr:1 Vec:4
Recovered........: 0/1 (0.00%) Digests
Progress.........: 0/1000003 (0.00%)
Rejected.........: 0/0 (0.00%)
Restore.Point....: 0/1000003 (0.00%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:56448-56512
Candidate.Engine.: Device Generator
Candidates.#1....: 123456 -&gt; time

[s]tatus [p]ause [b]ypass [c]heckpoint [f]inish [q]uit =&gt;

Session..........: hashcat
Status...........: Running
Hash.Mode........: 9600 (MS Office 2013)
Hash.Target......: $office$*2013*100000*256*16*ff2563844faca58a12fc42c...4336a2
Time.Started.....: Fri Jul 15 10:21:09 2022 (4 mins, 19 secs)
Time.Estimated...: Fri Jul 15 13:28:41 2022 (3 hours, 3 mins)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:       89 H/s (6.10ms) @ Accel:1024 Loops:64 Thr:1 Vec:4
Recovered........: 0/1 (0.00%) Digests
Progress.........: 22528/1000003 (2.25%)
Rejected.........: 0/22528 (0.00%)
Restore.Point....: 22528/1000003 (2.25%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:51200-51264
Candidate.Engine.: Device Generator
Candidates.#1....: sandeep -&gt; luckyboy

Session..........: hashcat                                
Status...........: Cracked
Hash.Mode........: 9600 (MS Office 2013)
Hash.Target......: $office$*2013*100000*256*16*ff2563844faca58a12fc42c...4336a2
Time.Started.....: Fri Jul 15 10:21:09 2022 (4 mins, 24 secs)
Time.Estimated...: Fri Jul 15 10:25:33 2022 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:       89 H/s (6.16ms) @ Accel:1024 Loops:64 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 23552/1000003 (2.36%)
Rejected.........: 0/23552 (0.00%)
Restore.Point....: 22528/1000003 (2.25%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: sandeep -&gt; luckyboy
Started: Fri Jul 15 10:19:58 2022
Stopped: Fri Jul 15 10:25:36 2022</code></pre><p id="216276c6-8319-4372-87ba-50cd9c7c3ab4" class="">A senha para o documento MS_Word_Document.docx é <code>muenchen</code>.</p><pre id="5acac690-c049-4fc0-90aa-8e944da2597a" class="code"><code>root@INE:~# cat found.txt
$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2:muenchen</code></pre><h1 id="9e2e4923-5b5d-4897-b7fd-710537f24586" class=""><strong>solução</strong></h1><h1 id="bf5dfe14-181a-49ab-adbe-e9d955813dfb" class=""><strong>Quebrando o hash do usuário do Linux</strong></h1><p id="249e6963-bf94-4ae3-8887-749461b4d062" class="">Etapa 1: abra o link do laboratório para acessar a instância da GUI do Kali.</p><p id="31e55b79-44db-47a1-9b74-0c6aaa6b7b06" class="">Etapa 2: Nos sistemas operacionais Linux, o hash da senha do usuário é armazenado em um <code>/etc/shadow</code>arquivo . Use o comando para <code>cat</code>ler o arquivo e verifique a entrada do usuário &quot;admin&quot;.</p><p id="f3a569ab-6a12-4f99-9814-e8b9d5fdfdd8" class=""><strong>Ordem</strong></p><pre id="48ce858d-4eed-45b5-9c79-680556a5bf02" class="code"><code>cat /etc/shadow</code></pre><pre id="8edc4b70-51be-4177-9693-9d42352622dc" class="code"><code>
root@INE:~# cat /etc/shadow
root:$6$iF3IRYx/LG3fxScL$spZt1Ltgnu4zyhnD2nYDZ9FSSKKcV0fRwnA3JNIGveciJQTWkPgv3qhE.URwgSakGvrJFNdHrfwYc9JLEZiGF/:18604:0:99999:7:::
daemon:*:19002:0:99999:7:::
bin:*:19002:0:99999:7:::
sys:*:19002:0:99999:7:::
sync:*:19002:0:99999:7:::
games:*:19002:0:99999:7:::
man:*:19002:0:99999:7:::
lp:*:19002:0:99999:7:::
mail:*:19002:0:99999:7:::
news:*:19002:0:99999:7:::
uucp:*:19002:0:99999:7:::
proxy:*:19002:0:99999:7:::
www-data:*:19002:0:99999:7:::
backup:*:19002:0:99999:7:::
list:*:19002:0:99999:7:::
irc:*:19002:0:99999:7:::
gnats:*:19002:0:99999:7:::
nobody:*:19002:0:99999:7:::
_apt:*:19002:0:99999:7:::
systemd-network:*:19004:0:99999:7:::
systemd-resolve:*:19004:0:99999:7:::
systemd-timesync:*:19004:0:99999:7:::
messagebus:*:19004:0:99999:7:::
rtkit:*:19004:0:99999:7:::
xrdp:!:19004:0:99999:7:::
usbmux:*:19004:0:99999:7:::
avahi:*:19004:0:99999:7:::
pulse:*:19004:0:99999:7:::
sddm:*:19004:0:99999:7:::
geoclue:*:19004:0:99999:7:::
tomcat:!:19004:0:99999:7:::
mysql:!:19004:0:99999:7:::
stunnel4:!:19004:0:99999:7:::
_rpc:*:19004:0:99999:7:::
dnsmasq:*:19004:0:99999:7:::
sslh:!:19004:0:99999:7:::                                                                                                                                                                   
ntp:*:19004:0:99999:7:::                                                                                                                                                                    
arpwatch:!:19004:0:99999:7:::                                                                                                                                                               
Debian-exim:!:19004:0:99999:7:::                                                                                                                                                            
debian-tor:*:19004:0:99999:7:::                                                                                                                                                             
redsocks:!:19004:0:99999:7:::
rwhod:*:19004:0:99999:7:::
freerad:*:19004:0:99999:7:::
iodine:*:19004:0:99999:7:::
tcpdump:*:19004:0:99999:7:::
miredo:*:19004:0:99999:7:::
statd:*:19004:0:99999:7:::
redis:*:19004:0:99999:7:::
postgres:*:19004:0:99999:7:::
inetsim:*:19004:0:99999:7:::
sshd:*:19004:0:99999:7:::
Debian-snmp:!:19004:0:99999:7:::
_gvm:*:19004:0:99999:7:::
saned:*:19004:0:99999:7:::
king-phisher:*:19004:0:99999:7:::
_caldera:*:19004:0:99999:7:::
dradis:*:19004:0:99999:7:::
beef-xss:*:19004:0:99999:7:::
uuidd:*:19004:0:99999:7:::
memcache:!:19004:0:99999:7:::
arangodb:!:19004::::::
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::/</code></pre><p id="82e88ac0-6ae0-4d7c-830b-0442564b104e" class="">O hash do usuário administrador é descrito abaixo:</p><p id="6d17fff2-50c7-4e07-8e81-4882e4c026c5" class="">hash do usuário administrador</p><pre id="20e88c89-52e9-4956-afb4-4ecf8fe9aead" class="code"><code>
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::</code></pre><p id="fa435616-b999-49ea-b9f0-b8b8e68e1583" class="">Etapa 3: verifique o algoritmo de hash usado para fazer o hash da senha presente no arquivo shadow verificando<code>/etc/login.defs</code></p><p id="7c0fe7c4-807d-4d9c-875b-e65d5b22ded1" class=""><strong>Ordem</strong></p><pre id="0819c9be-87ae-4c41-a5f9-8a3be962e939" class="code"><code>grep -A 18 ENCRYPT_METHOD /etc/login.defs</code></pre><pre id="6d84dab0-2f11-4bc9-83c0-fe7a3d18ad23" class="code"><code>
root@INE:~# grep -A 18 ENCRYPT_METHOD /etc/login.defs
# This variable is deprecated. You should use ENCRYPT_METHOD.
#
#MD5_CRYPT_ENAB no

#
# If set to MD5 , MD5-based algorithm will be used for encrypting password
# If set to SHA256, SHA256-based algorithm will be used for encrypting password
# If set to SHA512, SHA512-based algorithm will be used for encrypting password
# If set to DES, DES-based algorithm will be used for encrypting password (default)
# Overrides the MD5_CRYPT_ENAB option
#
# Note: It is recommended to use a value consistent with
# the PAM modules configuration.
#
ENCRYPT_METHOD SHA512

#
# Only used if ENCRYPT_METHOD is set to SHA256 or SHA512.
#
# Define the number of SHA rounds.
# With a lot of rounds, it is more difficult to brute forcing the password.
# But note also that it more CPU resources will be needed to authenticate
# users.
#
# If not specified, the libc will choose the default number of rounds (5000).
# The values must be inside the 1000-999999999 range.
# If only one of the MIN or MAX values is set, then this value will be used.
# If MIN &gt; MAX, the highest value will be used.
#
# SHA_CRYPT_MIN_ROUNDS 5000
# SHA_CRYPT_MAX_ROUNDS 5000

################# OBSOLETED BY PAM ##############
#                                               #
# These options are now handled by PAM. Please  #
# edit the appropriate file in /etc/pam.d/ to   #</code></pre><p id="200dffd4-d285-4930-8246-cc9760ace541" class="">Use um algoritmo de hash <code>SHA512</code>.</p><p id="15eaf2fc-9ace-4941-8eaf-fcdbf6df1afb" class="">Passo 4: Copie a entrada para o usuário &quot;admin&quot; e salve-a em um novo arquivo.</p><p id="55790b43-2906-42d8-94ed-19b153155918" class=""><strong>Ordem</strong></p><pre id="f35f429e-9739-4513-830a-0f771e840bba" class="code"><code>
tail -n 1 /etc/shadow &gt; admin.hash
cat admin.hash</code></pre><ul id="80030c90-3bf7-454c-ac43-761d4ec0720f" class="bulleted-list"><li style="list-style-type:disc"><code>n 1</code><p id="7cb97a98-19ba-41b4-b013-8740f6721b8f" class="">: Leia a última linha do arquivo /etc/shadow (entrada admin é a última linha do arquivo shadow)</p></li></ul><pre id="70babb9b-adf8-4da4-85dc-630707c9c6c7" class="code"><code>
root@INE:~# tail -n 1 /etc/shadow &gt; admin.hash
root@INE:~# cat admin.hash 
admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::/</code></pre><p id="992014bd-a052-49b3-ac92-1c5cc38d6918" class="">Passo 5: Temos que modificar a entrada para ser compatível com a entrada da ferramenta. Remova &quot;admin:&quot; e &quot;:18945:0:99999:7:::&quot;</p><pre id="fcf8106d-5d32-4e44-9fc0-c3fde2356ad2" class="code"><code>admin:$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:18945:0:99999:7:::/</code></pre><pre id="219149b9-8c3c-4191-953a-c15af8273872" class="code"><code>
$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/</code></pre><p id="29600980-9210-4334-ae48-2e3ffcce8b37" class="">Após a modificação, a entrada ficará assim:</p><p id="6db5e22c-8b3b-4a9e-92f0-bbdd037d97f8" class="">hash final</p><pre id="f173e051-d2c6-4b6b-bfa0-6c3081184e95" class="code"><code>
$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/</code></pre><h3 id="ff8a8d0b-9f3f-436c-b90b-df177f5ab310" class=""><strong>Usando Hashcat</strong></h3><p id="4dc70a1d-8545-4021-842b-b39ce22ec056" class="">Passo 6: Use a ferramenta Hashcat para quebrar o hash</p><p id="52fae645-3e85-476c-b7dc-4d2bb1c5566a" class=""><strong>Ordem</strong></p><pre id="c49141ca-df0d-4e31-a1ba-9eb5fe16a4ec" class="code"><code>
hashcat -m 1800 -a 0 admin.hash /root/Desktop/wordlists/1000000-password-seclists.txt</code></pre><p id="e1b76fc1-5d72-4451-a243-490d2f9021d3" class="">Hashcat:</p><ul id="d025c495-b9fd-4cdc-b3cb-292894b36aed" class="bulleted-list"><li style="list-style-type:disc">Código aberto, ferramenta poderosa de quebra de senha</li></ul><ul id="2323465a-2c01-494e-939a-7d8e215f8d1c" class="bulleted-list"><li style="list-style-type:disc">Suporta vários sistemas operacionais (Linux, Windows e macOS)</li></ul><ul id="f493d944-e48d-472c-80ee-e8cc5ecc7a96" class="bulleted-list"><li style="list-style-type:disc">Suporta mais de 350 algoritmos</li></ul><pre id="83a5a621-1486-4163-b15c-1cc2e4556d4d" class="code"><code>


root@INE:~# hashcat -m 1800 -a 0 admin.hash /root/Desktop/wordlists/1000000-password-seclists.txt 
hashcat (v6.2.5) starting

OpenCL API (OpenCL 2.0 pocl 1.8  Linux, None+Asserts, RELOC, LLVM 11.1.0, SLEEF, DISTRO, POCL_DEBUG) - Platform #1 [The pocl project]
=====================================================================================================================================
* Device #1: pthread-AMD EPYC 7642 48-Core Processor, 47227/94518 MB (16384 MB allocatable), 48MCU

Minimum password length supported by kernel: 0
Maximum password length supported by kernel: 256

Hashes: 1 digests; 1 unique digests, 1 unique salts
Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates
Rules: 1

Optimizers applied:
* Zero-Byte
* Single-Hash
* Single-Salt
* Uses-64-Bit

ATTENTION! Pure (unoptimized) backend kernels selected.
Pure kernels can crack longer passwords, but drastically reduce performance.
If you want to switch to optimized kernels, append -O to your commandline.
See the above message to find out about the exact limits.

Watchdog: Hardware monitoring interface not found on your system.
Watchdog: Temperature abort trigger disabled.

Host memory required for this attack: 0 MB

Dictionary cache built:
* Filename..: /root/Desktop/wordlists/1000000-password-seclists.txt
* Passwords.: 1000003
* Bytes.....: 8529147
* Keyspace..: 1000003
* Runtime...: 0 secs

$6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9isy7knhpskIEQG.s9eB8auxVqrroksib7uQyiCtrJIgr48XmR8o7Pa7O/:foxtrot
                                                          
Session..........: hashcat
Status...........: Cracked
Hash.Mode........: 1800 (sha512crypt $6$, SHA512 (Unix))
Hash.Target......: $6$2PjhBcvO4tMWKi5W$k/UUyb5mb3qTJ6Fr15cReTb0n/DQ9is...7Pa7O/
Time.Started.....: Fri Jul 15 17:47:07 2022 (4 secs)
Time.Estimated...: Fri Jul 15 17:47:11 2022 (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:      538 H/s (9.40ms) @ Accel:1024 Loops:32 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 2048/1000003 (0.20%)
Rejected.........: 0/2048 (0.00%)
Restore.Point....: 1024/1000003 (0.10%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:4992-5000
Candidate.Engine.: Device Generator
Candidates.#1....: sports -&gt; ball

Started: Fri Jul 15 17:45:57 2022
Stopped: Fri Jul 15 17:47:13 2022</code></pre><p id="fc130676-827c-4209-b6a2-529922506a5e" class="">A senha para o usuário &quot;admin&quot; é foxtrot.</p><h3 id="7d2503da-994c-44b1-90c8-ae1c00282405" class=""></h3><p id="65092fdb-65c0-4006-be79-dc1e76cf8e71" class="">Etapa 7: quebrando o hash usando  JTR</p><p id="a2b4d809-6149-4f8d-8d65-e8958047eb53" class="">Podemos executar o JTR diretamente no arquivo shadow.</p><p id="af8443a6-77d4-4d43-a8ef-c58f3f9183a5" class=""><strong>Ordem</strong></p><pre id="012d5a26-10b0-445b-8dbd-da7662da7527" class="code"><code>

john /etc/shadow --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt</code></pre><p id="0c1c4681-fbc0-4c1f-890c-4b3fe1ec4dc1" class="">
</p><ul id="551dbd22-d5a5-451b-b574-74b8a51cb7bb" class="bulleted-list"><li style="list-style-type:disc">Ferramenta de quebra de senha gratuita e de código aberto</li></ul><ul id="35c45375-6cae-407b-8b2e-895d1d87be53" class="bulleted-list"><li style="list-style-type:disc">Suporta vários sistemas operacionais (Linux, Windows e macOS)</li></ul><pre id="7a01ed31-1f9e-481e-aa24-168c9eb47d8d" class="code"><code>

root@INE:~# john /etc/shadow --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt 
Created directory: /root/.john
Using default input encoding: UTF-8
Loaded 2 password hashes with 2 different salts (sha512crypt, crypt(3) $6$ [SHA512 256/256 AVX2 4x])
Cost 1 (iteration count) is 5000 for all loaded hashes
Will run 48 OpenMP threads
Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status
foxtrot          (admin)     
password         (root)     
2g 0:00:00:07 DONE (2022-07-15 17:52) 0.2531g/s 777.7p/s 1555c/s 1555C/s 123456..786786
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.

root@INE:~# john --show /etc/shadow
root:password:18604:0:99999:7:::
admin:foxtrot:18945:0:99999:7:::/

2 password hashes cracked, 0 left</code></pre><p id="56e022f5-d310-4681-9153-a4a82cea5658" class="">As senhas para os usuários &quot;root&quot; e &quot;admin&quot; são senha e foxtrot respectivamente.</p><h1 id="5815eb89-b2b9-44ea-834e-e9f47a7accbc" class=""><strong>Quebre a senha de um arquivo do Microsoft Word</strong></h1><p id="64fdb010-a739-4212-94c3-ef24609c1dd0" class="">Passo 8: Vamos quebrar o arquivo &quot;MS_Word_Document.docx&quot; usando JTR e Hashcat.</p><p id="1f2efdac-0384-4235-9f56-ae85e28e86f9" class="">Localização do arquivo MS_Word_Document.docx<code>/root/Desktop/MS_Word_Document.docx</code></p><h3 id="40d2d514-fb86-4c92-a961-ce3d59acf134" class=""><strong>Usando JTR</strong></h3><p id="47145857-3093-435d-942f-1b42f4562401" class="">Primeiro, precisamos <code>office2john</code>extrair as informações quebráveis do arquivo usando um script python.</p><p id="0f954fd2-0e03-49c7-8663-014200859f78" class=""><strong>Ordem</strong></p><pre id="b9571da4-78f7-4a32-9734-c0570b9f2bc0" class="code"><code>

cd /root/Desktop/
/usr/share/john/office2john.py MS_Word_Document.docx &gt; hash
cat hash</code></pre><p id="7f55fdda-f160-4dfe-8a6d-31f40dc01838" class=""><code>office2john.py</code>é um script python para extrair informações quebráveis de arquivos .docx do Microsoft Office.</p><pre id="0277cfac-74e9-4457-8e52-2083da6a32ca" class="code"><code>

root@INE:~# cd /root/Desktop/
root@INE:~/Desktop# /usr/share/john/office2john.py MS_Word_Document.docx &gt; hash
root@INE:~/Desktop# cat hash
MS_Word_Document.docx:$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><p id="6995f97a-a398-476f-b99c-8d83e68629ff" class="">Podemos observar que o arquivo é salvo da versão MS Office 2013.</p><p id="9757d55b-09b4-4e98-8b24-dbd140a21522" class="">Use a ferramenta John The Ripper para quebrar o hash.</p><p id="0d145dbc-c89e-4576-a218-d9bcf455dc39" class=""><strong>Ordem</strong></p><pre id="a50ec75e-82a0-430c-bf11-60e56a405f06" class="code"><code>

john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt hash</code></pre><pre id="72929978-aebf-47d3-b554-bba287ea6f62" class="code"><code>

root@INE:~/Desktop# john --wordlist=/root/Desktop/wordlists/1000000-password-seclists.txt hash
Using default input encoding: UTF-8
Loaded 1 password hash (Office, 2007/2010/2013 [SHA1 256/256 AVX2 8x / SHA512 256/256 AVX2 4x AES])
Cost 1 (MS Office version) is 2013 for all loaded hashes
Cost 2 (iteration count) is 100000 for all loaded hashes
Will run 48 OpenMP threads
Press &#x27;q&#x27; or Ctrl-C to abort, almost any other key for status
muenchen         (MS_Word_Document.docx)     
1g 0:00:04:53 DONE (2022-07-15 18:09) 0.003405g/s 81.08p/s 81.08c/s 81.08C/s shake..963741
Use the &quot;--show&quot; option to display all of the cracked passwords reliably
Session completed.</code></pre><p id="a8055ef7-23a6-4749-b093-f521e7a3442f" class="">A senha usada para criptografar o arquivo docx é <strong>muenchen</strong></p><h3 id="119cd7d6-c137-40aa-991f-cab515313bf7" class=""><strong>Usando Hashcat</strong></h3><p id="badcbbd7-6466-4906-a5cc-1e1cf626ff68" class="">Passo 9: Novamente, usaremos a ferramenta Hashcat para recuperar a senha.</p><p id="42a9c174-023a-4dcd-af68-0e76b13c9e5d" class="">Precisamos tornar as informações quebráveis extraídas compatíveis com a ferramenta Hashcat. Remova o <code>MS_Word_Document.docx:</code>valor do arquivo.</p><pre id="0d2ae4f6-52ab-4c20-b6d3-4317bb27f545" class="code"><code>

MS_Word_Document.docx:$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><p id="e6b64c32-52e1-46b1-9620-123099bb02a2" class="">Exclua a área destacada.</p><pre id="81417491-b6f1-44c8-9512-5d19b82ac407" class="code"><code>

$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><p id="4c7e9245-4452-4064-a888-cbb48b4f2d65" class="">conteúdo final</p><pre id="6d9f83b2-3efd-4f99-8745-6087052b861a" class="code"><code>

$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2</code></pre><p id="1273fcba-1a0a-4cbf-928c-f3ce80b56a2e" class="">Quebrando o hash com Hashcat</p><p id="803ee8d2-dc96-4d14-a188-d1f686ca996f" class=""><strong>Ordem</strong></p><pre id="956cbe24-af73-4139-9b70-4f3075961001" class="code"><code>

hashcat -a 0 -m 9600 --status hash /root/Desktop/wordlists/1000000-password-seclists.txt --force</code></pre><p id="a713f0cc-5070-4fd4-8170-54b565b9712e" class="">Descrição do comando:</p><ul id="4117b040-5575-4eb7-b2d8-b85aa02d2ed0" class="bulleted-list"><li style="list-style-type:disc"><code>a 0</code><p id="36fdceb4-613d-4c15-861b-2c98e9d7fb04" class="">: defina o modo de ataque para o dicionário</p></li></ul><ul id="336096e8-8f02-49f2-b4f8-aae365534b38" class="bulleted-list"><li style="list-style-type:disc"><code>m 9600</code><p id="f87c7d0c-57c1-4bf1-b8ad-6cebf253cb19" class="">: Defina o método para MS Office 2013</p></li></ul><ul id="0836ed64-5749-405e-a12d-344f3485d3e1" class="bulleted-list"><li style="list-style-type:disc"><code>-status</code><p id="ff72a1ca-c592-4229-a46c-4ef22dcee48e" class="">: Habilitar atualizações automáticas da tela de status</p></li></ul><p id="4c36ab34-4c04-45da-94d1-f484ae05a5f2" class=""><code>hash</code>: arquivo contendo informações quebráveis</p><p id="180edfd8-4239-4de7-a363-1e919207a409" class=""><code>/root/Desktop/wordlists/1000000-password-seclists.txt</code>: vocabulário de senha</p><pre id="184a2ff7-bbf4-4d2b-8e8d-8e051dc40d78" class="code"><code>


$office$*2013*100000*256*16*ff2563844faca58a12fc42c5036f9cf8*ffaf52db903dbcb6ac2db4bab6d343ab*c237403ec97e5f68b7be3324a8633c9ff95e0bb44b1efcf798c70271a54336a2:muenchen
Session..........: hashcat                                
Status...........: Cracked
Hash.Mode........: 9600 (MS Office 2013)
Hash.Target......: $office$*2013*100000*256*16*ff2563844faca58a12fc42c...4336a2
Time.Started.....: Fri Jul 15 18:22:48 2022, (4 mins, 23 secs)
Time.Estimated...: Fri Jul 15 18:27:11 2022, (0 secs)
Kernel.Feature...: Pure Kernel
Guess.Base.......: File (/root/Desktop/wordlists/1000000-password-seclists.txt)
Guess.Queue......: 1/1 (100.00%)
Speed.#1.........:       89 H/s (13.95ms) @ Accel:1024 Loops:128 Thr:1 Vec:4
Recovered........: 1/1 (100.00%) Digests
Progress.........: 23552/1000003 (2.36%)
Rejected.........: 0/23552 (0.00%)
Restore.Point....: 22528/1000003 (2.25%)
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:0-1
Candidate.Engine.: Device Generator
Candidates.#1....: sandeep -&gt; luckyboy
Started: Fri Jul 15 18:22:07 2022
Stopped: Fri Jul 15 18:27:14 2022</code></pre><p id="0de1fdf4-c952-4e7e-a1d3-e93c65ecd1ae" class="">A senha usada para criptografar o arquivo docx é<code>muenchen</code></p><p id="ca3c48f8-55c2-41ae-a29b-f7afdab973e2" class="">É assim que usamos Hashcat e JTR para quebrar hashes e recuperar senhas para arquivos de documentos criptografados da Microsoft</p></div></article></body></html>
